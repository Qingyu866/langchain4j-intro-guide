<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>èŠå¤©ç›‘å¬å™¨ - LangChain4j å­¦ä¹ æŒ‡å—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-gray-800 antialiased">
    <div class="flex min-h-screen">
        <aside class="w-[280px] fixed left-0 top-0 h-full bg-white border-r border-gray-200 overflow-y-auto z-50">
            <a href="index.html" class="flex items-center gap-3 mb-8 text-gray-900 no-underline">
                <div class="w-9 h-9 bg-indigo-600 rounded-lg flex items-center justify-center text-white text-xl">âš¡</div>
                <span class="font-bold text-xl">LangChain4j</span>
            </a>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">å…¥é—¨</div>
                <ul class="list-none">
                    <li><a href="index.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">é¦–é¡µ</a></li>
                    <li><a href="getting-started.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">å¿«é€Ÿå…¥é—¨</a></li>
                    <li><a href="core-concepts.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æ ¸å¿ƒæ¦‚å¿µ</a></li>
                </ul>
            </div>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">æ ¸å¿ƒåŠŸèƒ½</div>
                <ul class="list-none">
                    <li><a href="embedding-models.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">åµŒå…¥æ¨¡å‹</a></li>
                    <li><a href="prompt-templates.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æç¤ºæ¨¡æ¿</a></li>
                    <li><a href="output-parsers.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">è¾“å‡ºè§£æ</a></li>
                    <li><a href="function-calling-deep.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">å‡½æ•°è°ƒç”¨</a></li>
                    <li><a href="advanced-features.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">é«˜çº§ç‰¹æ€§</a></li>
                    <li><a href="multimodal-full.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">å¤šæ¨¡æ€å¤„ç†</a></li>
                </ul>
            </div>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">RAG å®Œæ•´æŒ‡å—</div>
                <ul class="list-none">
                    <li><a href="rag-complete.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">RAG å®Œæ•´æŒ‡å—</a></li>
                    <li><a href="project-rag-kb.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">RAG çŸ¥è¯†åº“é¡¹ç›®</a></li>
                </ul>
            </div>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">é¡¹ç›®å®æˆ˜</div>
                <ul class="list-none">
                    <li><a href="project-ai-assistant.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">AI åŠ©æ‰‹é¡¹ç›®</a></li>
                    <li><a href="project-chatbot.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">èŠå¤©æœºå™¨äººé¡¹ç›®</a></li>
                </ul>
            </div>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">æ·±å…¥ä¸æœ€ä½³å®è·µ</div>
                <ul class="list-none">
                    <li><a href="best-practices.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æœ€ä½³å®è·µ</a></li>
                    <li><a href="examples.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">ä»£ç ç¤ºä¾‹</a></li>
                    <li><a href="integrations.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æ¡†æ¶é›†æˆ</a></li>
                    <li><a href="testing-strategies.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æµ‹è¯•ç­–ç•¥</a></li>
                    <li><a href="performance-tuning.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æ€§èƒ½è°ƒä¼˜</a></li>
                    <li><a href="deep-dive.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æ·±åº¦è§£æ</a></li>
                    <li><a href="error-handling.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">é”™è¯¯å¤„ç†</a></li>
                    <li><a href="moderation-safety.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æµ‹è¯•ç­–ç•¥</a></li>
                    <li><a href="troubleshooting.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æ•…éšœæ’æŸ¥</a></li>
                </ul>
            </div>

            <div class="mb-8">
                <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">é«˜çº§ä¸»é¢˜</div>
                <ul class="list-none">
                    <li><a href="interview-prep.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">é¢è¯•å‡†å¤‡</a></li>
                    <li><a href="practice.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">å®æˆ˜ç»ƒä¹ </a></li>
                    <li><a href="search.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æœç´¢åŠŸèƒ½</a></li>
                    <li><a href="chat-listeners.html" class="block bg-primary-50 text-indigo-700 no-underline py-2 px-3 text-sm rounded-md font-medium">èŠå¤©ç›‘å¬å™¨</a></li>
                    <li><a href="faq.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">å¸¸è§é—®é¢˜</a></li>
                    <li><a href="cost-optimization.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">æˆæœ¬ä¼˜åŒ–</a></li>
                    <li><a href="deployment.html" class="block text-gray-600 no-underline py-2 px-3 text-sm rounded-md hover:bg-gray-100 transition-all">éƒ¨ç½²ä¸è¿ç»´</a></li>
                </ul>
            </div>
        </aside>

        <main class="flex-1 ml-[280px]">
            <div class="max-w-7xl mx-auto px-8 py-12">
                <!-- é¡µé¢æ ‡ç­¾ -->
                <div class="flex items-center gap-2 mb-4">
                    <span class="px-3 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full">èŠå¤©ç›‘å¬å™¨</span>
                    <span class="px-3 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded-full">äº‹ä»¶å¤„ç†</span>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full">å¼‚æ­¥ç¼–ç¨‹</span>
                </div>

                <h1 class="text-4xl font-bold text-gray-900 mb-4">èŠå¤©ç›‘å¬å™¨</h1>
                <p class="text-xl text-gray-600 mb-8">LangChain4j çš„èŠå¤©ç›‘å¬å™¨æœºåˆ¶ä¸äº‹ä»¶å¤„ç†</p>

                <!-- ç›®å½• -->
                <nav class="bg-gray-50 border border-gray-200 rounded-xl p-6 mb-8">
                    <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">ç›®å½•</h3>
                    <ol class="space-y-2 text-sm text-gray-700">
                        <li class="flex items-start gap-2"><span class="text-indigo-600 font-medium">1.</span> <a href="#ç›‘å¬å™¨æ¦‚è¿°" class="hover:text-indigo-600 transition-colors">ç›‘å¬å™¨æ¦‚è¿°</a></li>
                        <li class="flex items-start gap-2"><span class="text-indigo-600 font-medium">2.</span> <a href="#ç›‘å¬å™¨ç±»å‹" class="hover:text-indigo-600 transition-colors">ç›‘å¬å™¨ç±»å‹</a></li>
                        <li class="flex items-start gap-2"><span class="text-indigo-600 font-medium">3.</span> <a href="#ç›‘å¬å™¨å®ç°" class="hover:text-indigo-600 transition-colors">ç›‘å¬å™¨å®ç°</a></li>
                        <li class="flex items-start gap-2"><span class="text-indigo-600 font-medium">4.</span> <a href="#å®æˆ˜åº”ç”¨" class="hover:text-indigo-600 transition-colors">å®æˆ˜åº”ç”¨</a></li>
                    </ol>
                </nav>

                <!-- ç¬¬1èŠ‚ï¼šç›‘å¬å™¨æ¦‚è¿° -->
                <section id="ç›‘å¬å™¨æ¦‚è¿°" class="mb-16">
                    <div class="flex items-center gap-3 mb-6">
                        <span class="flex items-center justify-center w-8 h-8 bg-indigo-600 text-white rounded-full text-sm font-bold">1</span>
                        <h2 class="text-2xl font-bold text-gray-900">ç›‘å¬å™¨æ¦‚è¿°</h2>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">1.1 ç›‘å¬å™¨æ¦‚å¿µ</h3>
                    <p class="text-gray-700 mb-6">èŠå¤©ç›‘å¬å™¨æ˜¯ LangChain4j æä¾›çš„ä¸€ç§äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œç”¨äºç›‘å¬å’Œå“åº”èŠå¤©è¿‡ç¨‹ä¸­çš„å„ç§äº‹ä»¶ï¼š</p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-2">äº‹ä»¶ç±»å‹</h4>
                            <p class="text-blue-700 text-sm">ç›‘å¬å™¨å¯ä»¥å“åº”å¤šç§äº‹ä»¶ï¼š</p>
                            <ul class="text-blue-600 text-xs space-y-1">
                                <li>â€¢ æ¶ˆæ¯å‘é€å‰</li>
                                <li>â€¢ æ¶ˆæ¯å‘é€å</li>
                                <li>â€¢ æ¨¡å‹å¼€å§‹ç”Ÿæˆ</li>
                                <li>â€¢ æ¨¡å‹ç”Ÿæˆå®Œæˆ</li>
                                <li>â€¢ Token ä½¿ç”¨æ›´æ–°</li>
                            </ul>
                        </div>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-2">åº”ç”¨åœºæ™¯</h4>
                            <p class="text-green-700 text-sm">ç›‘å¬å™¨çš„å…¸å‹åº”ç”¨åœºæ™¯ï¼š</p>
                            <ul class="text-green-600 text-xs space-y-1">
                                <li>â€¢ æ—¥å¿—è®°å½•å’Œå®¡è®¡</li>
                                <li>â€¢ Token ä½¿ç”¨ç›‘æ§</li>
                                <li>â€¢ æ¶ˆæ¯ä¸­é—´ä»¶å¤„ç†</li>
                                <li>â€¢ è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘è§¦å‘</li>
                                <li>â€¢ æµç¨‹æ§åˆ¶å’Œæ‹¦æˆª</li>
                            </ul>
                        </div>
                        <div class="purple-50 border border-purple-200 rounded-lg p-4">
                            <h4 class="font-semibold text-purple-800 mb-2">æ ¸å¿ƒä¼˜åŠ¿</h4>
                            <p class="text-purple-700 text-sm">ä½¿ç”¨ç›‘å¬å™¨çš„ä¼˜åŠ¿ï¼š</p>
                            <ul class="text-purple-600 text-xs space-y-1">
                                <li>â€¢ è§£è€¦ï¼šå°†ä¸šåŠ¡é€»è¾‘ä»ä¸»æµç¨‹ä¸­åˆ†ç¦»</li>
                                <li>â€¢ å¯æµ‹è¯•ï¼šç‹¬ç«‹æµ‹è¯•ç›‘å¬å™¨é€»è¾‘</li>
                                <li>â€¢ å¯æ‰©å±•ï¼šåŠ¨æ€æ·»åŠ å’Œç§»é™¤ç›‘å¬å™¨</li>
                                <li>â€¢ è§‚å¯Ÿè€…æ¨¡å¼ï¼šæ˜“äºå®ç°å¤æ‚çš„äº‹ä»¶é“¾</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- ç¬¬2èŠ‚ï¼šç›‘å¬å™¨ç±»å‹ -->
                <section id="ç›‘å¬å™¨ç±»å‹" class="mb-16">
                    <div class="flex items-center gap-3 mb-6">
                        <span class="flex items-center justify-center w-8 h-8 bg-indigo-600 text-white rounded-full text-sm font-bold">2</span>
                        <h2 class="text-2xl font-bold text-gray-900">ç›‘å¬å™¨ç±»å‹</h2>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">2.1 å†…ç½®ç›‘å¬å™¨</h3>
                    <p class="text-gray-700 mb-6">LangChain4j æä¾›äº†å¤šç§å†…ç½®ç›‘å¬å™¨ï¼š</p>

                    <table class="w-full text-left border-collapse border border-gray-200 rounded-lg overflow-hidden mb-6">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-sm font-semibold text-gray-500">ç›‘å¬å™¨</th>
                                <th class="px-6 py-3 text-sm font-semibold text-gray-500">è§¦å‘æ—¶æœº</th>
                                <th class="px-6 py-3 text-sm font-semibold text-gray-500">ç”¨é€”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-200">
                                <td class="px-6 py-3"><strong>ModelListener</strong></td>
                                <td class="px-6 py-3">æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ä¸­</td>
                                <td class="px-6 py-3">ç›‘æ§æ¨¡å‹å“åº”ã€æµå¼è¾“å‡ºå¤„ç†</td>
                            </tr>
                            <tr class="border-b border-gray-200">
                                <td class="px-6 py-3"><strong>TokenListener</strong></td>
                                <td class="px-6 py-3">Token ä½¿ç”¨æ—¶</td>
                                <td class="px-6 py-3">å®æ—¶ç›‘æ§ Token æ¶ˆè€—ã€é¢„ç®—æ§åˆ¶</td>
                            </tr>
                            <tr class="border-b border-gray-200">
                                <td class="px-6 py-3"><strong>ChatMemoryListener</strong></td>
                                <td class="px-6 py-3">èŠå¤©è®°å¿†æ›´æ–°æ—¶</td>
                                <td class="px-6 py-3">è®°å¿†æŒä¹…åŒ–ã€ä¸Šä¸‹æ–‡ç®¡ç†</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-3"><strong>ToolExecutionListener</strong></td>
                                <td class="px-6 py-3">å·¥å…·æ‰§è¡Œæ—¶</td>
                                <td class="px-6 py-3">æ—¥å¿—è®°å½•ã€æƒé™æ£€æŸ¥ã€ç»“æœå¤„ç†</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- ç¬¬3èŠ‚ï¼šç›‘å¬å™¨å®ç° -->
                <section id="ç›‘å¬å™¨å®ç°" class="mb-16">
                    <div class="flex items-center gap-3 mb-6">
                        <span class="flex items-center justify-center w-8 h-8 bg-indigo-600 text-white rounded-full text-sm font-bold">3</span>
                        <h2 class="text-2xl font-bold text-gray-900">ç›‘å¬å™¨å®ç°</h2>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">3.1 ModelListener ç¤ºä¾‹</h3>
                    <p class="text-gray-700 mb-6">ä½¿ç”¨ ModelListener ç›‘æ§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ï¼š</p>

                    <div class="relative mb-6">
                        <div class="absolute top-0 right-0 px-3 py-1 bg-gray-800 text-gray-400 text-xs font-medium rounded-bl-md">ModelListenerExample.java</div>
                        <pre class="bg-gray-900 text-gray-100 rounded-lg p-5 overflow-x-auto"><code class="text-sm"><span class="text-purple-400">package</span> <span class="text-blue-300">com.example.langchain4j.listeners</span>;

<span class="text-purple-400">import</span> <span class="text-blue-300">dev.langchain4j.model.chat.listener.ModelListener</span>;
<span class="text-purple-400">import</span> <span class="text-blue-300">dev.langchain4j.model.chat.ChatLanguageModel</span>;
<span class="text-purple-400">import</span> <span class="text-blue-300">dev.langchain4j.model.chat.listener.ChatMemoryContext</span>;
<span class="text-purple-400">import</span> <span class="text-blue-300">dev.langchain4j.model.chat.listener.ChatMemoryId</span>;

<span class="text-gray-500">/**
 * æ¨¡å‹ç›‘å¬å™¨ç¤ºä¾‹
 * ç›‘æ§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹å¹¶è®°å½•æ—¥å¿—
 */</span>
<span class="text-purple-400">public class</span> <span class="text-yellow-300">LoggingModelListener</span> <span class="text-purple-400">implements</span> <span class="text-blue-300">ModelListener</span> {

    <span class="text-purple-400">@Override</span>
    <span class="text-purple-400">public void</span> <span class="text-purple-400">onRequest</span>(<span class="text-blue-300">ChatMemoryContext</span> context, <span class="text-blue-300">ChatMemoryId</span> memoryId) {
        <span class="text-gray-500">// è®°å½•è¯·æ±‚å¼€å§‹</span>
        <span class="text-blue-300">System</span>.<span class="text-green-300">out</span>.<span class="text-green-300">printf</span>(<span class="text-green-300">"[%s] è¯·æ±‚å¼€å§‹ - Memory ID: %s"</span>, 
            context.<span class="text-green-300">chatMemoryId</span>(), memoryId);
    }

    <span class="text-purple-400">@Override</span>
    <span class="text-purple-400">public void</span> <span class="text-purple-400">onResponse</span>(<span class="text-blue-300">ChatMemoryContext</span> context, <span class="text-blue-300">ChatMemoryId</span> memoryId, <span class="text-blue-300">AiMessage</span> response) {
        <span class="text-gray-500">// è®°å½•å“åº”å®Œæˆ</span>
        <span class="text-blue-300">System</span>.<span class="text-green-300">out</span>.<span class="text-green-300">printf</span>(<span class="text-green-300">"[%s] å“åº”å®Œæˆ - Memory ID: %s - å†…å®¹: %s"</span>,
            context.<span class="text-green-300">chatMemoryId</span>(), memoryId, response.<span class="text-green-300">text</span>());
    }

    <span class="text-purple-400">@Override</span>
    <span class="text-purple-400">public void</span> <span class="text-purple-400">onError</span>(<span class="text-blue-300">ChatMemoryContext</span> context, <span class="text-blue-300">ChatMemoryId</span> memoryId, <span class="text-blue-300">Throwable</span> error) {
        <span class="text-gray-500">// è®°å½•é”™è¯¯</span>
        <span class="text-blue-300">System</span>.<span class="text-green-300">err</span>.<span class="text-green-300">println</span>(<span class="text-green-300">"[%s] é”™è¯¯å‘ç”Ÿ - Memory ID: %s - Error: %s"</span>,
            context.<span class="text-green-300">chatMemoryId</span>(), memoryId, error.<span class="text-green-300">getMessage</span>());
    }
}</code></pre>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">3.2 TokenListener ç¤ºä¾‹</h3>
                    <p class="text-gray-700 mb-6">ä½¿ç”¨ TokenListener ç›‘æ§ Token ä½¿ç”¨ï¼š</p>

                    <div class="relative mb-6">
                        <div class="absolute top-0 right-0 px-3 py-1 bg-gray-800 text-gray-400 text-xs font-medium rounded-bl-md">TokenListenerExample.java</div>
                        <pre class="bg-gray-900 text-gray-100 rounded-lg p-5 overflow-x-auto"><code class="text-sm"><span class="text-purple-400">package</span> <span class="text-blue-300">com.example.langchain4j.listeners</span>;

<span class="text-purple-400">import</span> <span class="text-blue-300">dev.langchain4j.model.chat.listener.TokenListener</span>;
<span class="text-purple-400">import</span> <span class="text-blue-300">java.util.concurrent.atomic.AtomicLong</span>;

<span class="text-gray-500">/**
 * Token ä½¿ç”¨ç›‘å¬å™¨ç¤ºä¾‹
 * å®æ—¶ç›‘æ§ Token æ¶ˆè€—å’Œæˆæœ¬
 */</span>
<span class="text-purple-400">public class</span> <span class="text-yellow-300">BudgetTokenListener</span> <span class="text-purple-400">implements</span> <span class="text-blue-300">TokenListener</span> {

    <span class="text-purple-400">private final</span> <span class="text-blue-300">AtomicLong</span> totalTokens = <span class="text-purple-400">new</span> <span class="text-blue-300">AtomicLong</span>(<span class="text-green-300">0</span>);
    <span class="text-purple-400">private static final</span> <span class="text-blue-300">double</span> <span class="text-yellow-300">BUDGET_THRESHOLD</span> = <span class="text-green-300">100000</span>; <span class="text-gray-500">// é¢„ç®—é˜ˆå€¼ï¼š10 ä¸‡ tokens</span>

    <span class="text-purple-400">@Override</</span>
    <span class="text-purple-400">public void</span> <span class="text-purple-400">onToken</span>(<span class="text-blue-300">int</span> tokens, <span class="text-blue-300">TokenRequest</span> request) {
        <span class="text-blue-300">long</span> currentTotal = totalTokens.<span class="text-green-300">addAndGet</span>(tokens);
        
        <span class="text-gray-500">// æ£€æŸ¥æ˜¯å¦è¶…è¿‡é¢„ç®—</span>
        <span class="text-purple-400">if</span> (currentTotal &gt; <span class="text-yellow-300">BUDGET_THRESHOLD</span>) {
            <span class="text-blue-300">System</span>.<span class="text-green-300">out</span>.<span class="text-green-300">println</span>(<span class="text-green-300">"âš ï¸  è­¦å‘Šï¼šToken ä½¿ç”¨è¶…è¿‡é¢„ç®—ï¼å½“å‰: "</span> + currentTotal + <span class="text-green-300">"</span>);
            <span class="text-gray-500">// å¯é€‰æ‹©ï¼šæŠ›å‡ºå¼‚å¸¸ã€é™ä½æ¨¡å‹è´¨é‡ã€æ‹’ç»è¯·æ±‚</span>
        }
    }
}</code></pre>
                    </div>
                </section>

                <!-- ç¬¬4èŠ‚ï¼šå®æˆ˜åº”ç”¨ -->
                <section id="å®æˆ˜åº”ç”¨" class="mb-16">
                    <div class="flex items-center gap-3 mb-6">
                        <span class="flex items-center justify-center w-8 h-8 bg-indigo-600 text-white rounded-full text-sm font-bold">4</span>
                        <h2 class="text-2xl font-font-bold text-gray-900">å®æˆ˜åº”ç”¨</h2>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">4.1 é›†æˆç›‘å¬å™¨</h3>
                    <p class="text-gray-700">å°†ç›‘å¬å™¨é›†æˆåˆ° ChatLanguageModelï¼š</p>

                    <div class="relative mb-6">
                        <div class="absolute top-0 right-0 px-3 py-1 bg-gray-800 text-gray-400 text-xs font-medium rounded-bl-md">ListenerIntegration.java</div>
                        <pre class="bg-gray-900 text-gray-100 rounded-lg p-5 overflow-x-auto"><code class="text-sm"><span class="text-purple-400">public class</span> <span class="text-yellow-300">ListenerIntegration</span> {

    <span class="text-purple-400">private final</span> <span class="text-blue-300">ChatLanguageModel</span> chatModel;
    <span class="text-purple-400">private final</span> <span class="text-blue-300">ModelListener</span> loggingListener;
    <span class="text-purple-400">private final</span> <span class="text-blue-300">TokenListener</span> tokenListener;

    <span class="text-purple-400">public</span> <span class="text-yellow-300">ListenerIntegration</span>(<span class="text-blue-300">ChatLanguageModel</span> chatModel) {
        <span class="text-purple-400">this</span>.chatModel = chatModel;
        <span class="text-purple-400">this</span>.loggingListener = <span class="text-purple-400">new</span> <span class="text-yellow-300">LoggingModelListener</span>();
        <span class="text-purple-400">this</span>.tokenListener = <span class="text-purple-400">new</span> <span class="text-yellow-300">BudgetTokenListener</span>();
        
        <span class="text-gray-500">// æ³¨å†Œç›‘å¬å™¨</span>
        chatModel.<span class="text-green-300">addListener</span>(loggingListener);
        chatModel.<span class="text-green-300">addListener</span>(tokenListener);
    }

    <span class="text-gray-500">/**
     * å‘é€æ¶ˆæ¯å¹¶ä½¿ç”¨ç›‘å¬å™¨
     */</span>
    <span class="text-purple-400">public</span> <span class="text-blue-300">String</span> <span class="text-purple-400">sendMessageWithListeners</span>(<span class="text-blue-300">String</span> message) {
        <span class="text-purple-400">return</span> chatModel.<span class="text-green-300">generate</span>(message);
    }
}</code></pre>
                    </div>

                    <h3 class="text-xl font-semibold text-gray-900 mb-4">4.2 å¼‚æ­¥å¤„ç†</h3>
                    <p class="text-text-gray-700 mb-6">ç›‘å¬å™¨ä¸­çš„å¼‚æ­¥å¤„ç†æœ€ä½³å®è·µï¼š</p>

                    <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                        <h4 class="font-semibold text-green-800 mb-3">å¼‚æ­¥æ³¨æ„äº‹é¡¹</h4>
                        <ul class="text-green-700 space-y-2">
                            <li><strong>é¿å…é˜»å¡</strong>ï¼šç›‘å¬å™¨ä¸­ä¸è¦æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œä½¿ç”¨å¼‚æ­¥ API</li>
                            <li><strong>é”™è¯¯å¤„ç†</strong>ï¼šç›‘å¬å™¨ä¸­çš„é”™è¯¯ä¸åº”å½±å“ä¸»æµç¨‹</li>
                            <li><strong>å¹‚ç­‰æ€§</strong>ï¼šç¡®ä¿ç›‘å¬å™¨é€»è¾‘å¯ä»¥å®‰å…¨é‡è¯•</li>
                            <li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šç›‘å¬å™¨å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„</li>
                        </ul>
                    </div>

                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-6 mb-8">
                        <h3 class="text-xl font-bold text-white mb-2">ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“</h3>
                        <ul class="text-indigo-100 space-y-2">
                            <li><strong>è½»é‡çº§ç›‘å¬å™¨</strong>ï¼šå¿«é€Ÿæ‰§è¡Œï¼Œé¿å…å½±å“ä¸»æµç¨‹æ€§èƒ½</li>
                            <li><strong>åˆç†ä½¿ç”¨æ—¥å¿—</strong>ï¼šé€‚å½“çº§åˆ«è®°å½•å…³é”®äº‹ä»¶ï¼Œé¿å…è¿‡åº¦æ—¥å¿—</li>
                            <li><strong>ç»„åˆç›‘å¬å™¨</strong>ï¼šå¤šä¸ªç›‘å¬å™¨å¯ä»¥ååŒå·¥ä½œå®ç°å¤æ‚é€»è¾‘</li>
                            <li><strong>æµ‹è¯•è¦†ç›–</strong>ï¼šä¸ºç›‘å¬å™¨é€»è¾‘ç¼–å†™å•å…ƒæµ‹è¯•</li>
                            <li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šä½¿ç”¨ç›‘å¬å™¨å®ç°æˆæœ¬æ§åˆ¶å’Œå¼‚å¸¸å‘Šè­¦</li>
                        </ul>
                    </div>
                </section>

                <!-- æ€»ç»“ -->
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-8 text-white">
                    <h3 class="text-2xl font-bold mb-4">æœ¬èŠ‚å°ç»“</h3>
                    <p class="mb-4">æœ¬èŠ‚å®Œæ•´ä»‹ç»äº† LangChain4j çš„èŠå¤©ç›‘å¬å™¨æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š</p>
                    <ul class="list-disc list-inside space-y-2 mb-6">
                        <li><strong>ç›‘å¬å™¨æ¦‚è¿°</strong>ï¼šäº‹ä»¶ç±»å‹ã€åº”ç”¨åœºæ™¯ã€æ ¸å¿ƒä¼˜åŠ¿</li>
                        <li><strong>ç›‘å¬å™¨ç±»å‹</strong>ï¼šModelListenerã€TokenListenerã€ChatMemoryListenerã€ToolExecutionListener</li>
                        <li><strong>ç›‘å¬å™¨å®ç°</strong>ï¼šå®Œæ•´çš„ä»£ç ç¤ºä¾‹ã€é›†æˆæ–¹æ³•</li>
                        <li><strong>å®æˆ˜åº”ç”¨</strong>ï¼šç›‘å¬å™¨é›†æˆã€å¼‚æ­¥å¤„ç†ã€æœ€ä½³å®è·µ</li>
                    </ul>
                    <div class="border-t border-indigo-400 pt-6">
                        <p class="text-sm opacity-80 mb-2">ğŸ‰ æ­å–œï¼</p>
                        <p class="text-indigo-100 mb-2">æ‰€æœ‰é«˜çº§ä¸»é¢˜é¡µé¢å·²å®Œæˆï¼å‰©ä½™ 6 ä¸ªå…¥é—¨é¡µé¢å¯æ ¹æ®éœ€è¦è¡¥å……ã€‚</p>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
